<!-- src/app/features/leads/import-leads/import-leads.component.html -->
<div class="import-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-left">
      <h1> Import Leads</h1>
      <p>Upload CSV or Excel file to import multiple leads at once</p>
    </div>
    <button class="btn-back" (click)="cancel()">
      <i class="fas fa-times"></i>
      <span>Cancel</span>
    </button>
  </div>

  <!-- Upload Section -->
  <div class="upload-section" *ngIf="!showPreview">
    <!-- Upload Area -->
    <div 
      class="upload-area"
      [class.dragging]="isDragging"
      (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)"
      (drop)="onDrop($event)"
    >
      <div class="upload-icon">
        <i class="fas fa-cloud-upload-alt"></i>
      </div>
      <h3>Drag & Drop your file here</h3>
      <p class="upload-subtitle">or</p>
      <label for="fileInput" class="btn-browse">
        <i class="fas fa-folder-open"></i>
        <span>Browse Files</span>
      </label>
      <input 
        type="file" 
        id="fileInput" 
        accept=".csv,.xlsx,.xls"
        (change)="onFileSelected($event)"
        hidden
      />
      <p class="file-info">Supported: CSV, Excel (.xlsx, .xls) â€¢ Max size: 5MB</p>
    </div>

    <!-- Instructions Card -->
    <div class="instructions-card">
      <h3> File Requirements</h3>
      
      <div class="requirement-section">
        <h4>Required Columns:</h4>
        <ul class="requirement-list">
          <li>
            <i class="fas fa-check-circle"></i>
            <strong>name</strong> - Full name of the lead
          </li>
          <li>
            <i class="fas fa-check-circle"></i>
            <strong>email</strong> - Valid email address
          </li>
          <li>
            <i class="fas fa-check-circle"></i>
            <strong>phone</strong> - Contact phone number
          </li>
        </ul>
      </div>

      <div class="requirement-section">
        <h4>Optional Columns:</h4>
        <ul class="requirement-list optional">
          <li>
            <i class="fas fa-circle"></i>
            <strong>company</strong> - Company name
          </li>
          <li>
            <i class="fas fa-circle"></i>
            <strong>source</strong> - Lead source (Website, Walk-in, etc.)
          </li>
          <li>
            <i class="fas fa-circle"></i>
            <strong>notes</strong> - Additional information
          </li>
        </ul>
      </div>

      <button class="btn-template" (click)="downloadTemplate()">
        <i class="fas fa-download"></i>
        <span>Download Sample Template</span>
      </button>
    </div>
  </div>

  <!-- Processing Loader -->
  <div class="processing-loader" *ngIf="isProcessing">
    <i class="fas fa-spinner fa-spin"></i>
    <p>Processing file...</p>
  </div>

  <!-- Preview Section -->
  <div class="preview-section" *ngIf="showPreview && !isProcessing">
    <!-- File Info -->
    <div class="file-info-card">
      <div class="file-details">
        <i class="fas fa-file-csv"></i>
        <div class="file-meta">
          <div class="file-name">{{ fileName }}</div>
          <div class="file-size">{{ fileSize }}</div>
        </div>
      </div>
      <button class="btn-remove" (click)="removeFile()">
        <i class="fas fa-trash"></i>
        <span>Remove</span>
      </button>
    </div>

    <!-- Import Summary -->
    <div class="summary-cards">
      <div class="summary-card total">
        <i class="fas fa-file-alt"></i>
        <div class="summary-content">
          <div class="summary-label">Total Records</div>
          <div class="summary-value">{{ importedLeads.length }}</div>
        </div>
      </div>

      <div class="summary-card valid">
        <i class="fas fa-check-circle"></i>
        <div class="summary-content">
          <div class="summary-label">Valid Leads</div>
          <div class="summary-value">{{ validLeadsCount }}</div>
        </div>
      </div>

      <div class="summary-card invalid">
        <i class="fas fa-exclamation-triangle"></i>
        <div class="summary-content">
          <div class="summary-label">Invalid Leads</div>
          <div class="summary-value">{{ invalidLeadsCount }}</div>
        </div>
      </div>
    </div>

    <!-- Preview Table -->
    <div class="preview-card">
      <h3>Data Preview</h3>
      
      <div class="table-container">
        <table class="preview-table">
          <thead>
            <tr>
              <th>Status</th>
              <th>Name</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Company</th>
              <th>Source</th>
              <th>Issues</th>
            </tr>
          </thead>
          <tbody>
            <tr 
              *ngFor="let lead of importedLeads; let i = index"
              [class.valid-row]="lead.status === 'valid'"
              [class.invalid-row]="lead.status === 'invalid'"
            >
              <td>
                <span class="status-icon" [class.valid]="lead.status === 'valid'">
                  <i class="fas" [ngClass]="lead.status === 'valid' ? 'fa-check-circle' : 'fa-times-circle'"></i>
                </span>
              </td>
              <td>{{ lead.name }}</td>
              <td>{{ lead.email }}</td>
              <td>{{ lead.phone }}</td>
              <td>{{ lead.company || '-' }}</td>
              <td>{{ lead.source || '-' }}</td>
              <td>
                <div class="errors-cell" *ngIf="lead.errors && lead.errors.length > 0">
                  <span class="error-badge" *ngFor="let error of lead.errors">
                    {{ error }}
                  </span>
                </div>
                <span *ngIf="!lead.errors || lead.errors.length === 0" class="no-errors">-</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button 
        class="btn-primary" 
        (click)="importLeads()"
        [disabled]="validLeadsCount === 0"
      >
        <i class="fas fa-upload"></i>
        <span>Import {{ validLeadsCount }} Valid Lead{{ validLeadsCount !== 1 ? 's' : '' }}</span>
      </button>
      <button class="btn-secondary" (click)="removeFile()">
        <i class="fas fa-redo"></i>
        <span>Upload Different File</span>
      </button>
      <button class="btn-cancel" (click)="cancel()">
        <i class="fas fa-times"></i>
        <span>Cancel</span>
      </button>
    </div>
  </div>
</div>